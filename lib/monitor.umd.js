!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(e="undefined"!=typeof globalThis?globalThis:e||self).monitor=o()}(this,function(){"use strict";const n=window.requestIdleCallback||window.requestAnimationFrame||(e=>setTimeout(e,17)),r=e=>window.btoa(unescape(encodeURIComponent(e)));let t=[];let s={},i=void 0;function a(){if(t.length){const o=t.slice(0,5);t=t.slice(5);var e=Date.now();l("",{...s,sendTime:e,data:o.map(e=>e)}),t.length&&n(a)}}function c(e,o){if(!e)return"<Anonymous>";if(e.$root===e)return"<Root>";let n=(e=e.$options).name||e._componentTag;const t=e.__file;return((n=!n&&t&&(e=t.match(/([^/\\]+)\.vue$/))?e[1]:n)?`<${e=n,e.replace(d,e=>e.toUpperCase()).replace(/[-_]/g,"")}>`:"<Anonymous>")+(t&&o?"at "+t:"")}const o=function(e,o=!1){o?l("",{baseInfo:s,eventInfo:[e]}):(t.push(e),clearTimeout(i),5<=t.length?a():i=window.setTimeout(a,5e3))},l=(e,o)=>{console.log(e,"--------------url"),console.log(o,"--------------data")},u=(window.addEventListener("beforeunload",()=>{a()}),function(){var{host:e,hostname:o,href:n,protocol:t,origin:r,port:s,pathname:i,search:a,hash:c}=window.location,{width:l,height:u}=window.screen;const{language:d,userAgent:m}=navigator;return{host:e,hostname:o,href:n,protocol:t,origin:r,port:s,pathname:i,search:a,hash:c,title:document.title,language:d.substring(0,2),userAgent:m,winScreen:l+"x"+u,docScreen:`${document.documentElement.clientWidth||document.body.clientWidth}x`+(document.documentElement.clientHeight||document.body.clientHeight)}}),d=/(?:^|[-_])(\w)/g,m=function(e){e.config.errorHandler=function(e,o,n){n={type:"vueError",errorUid:r(`vue-${e.message}-`+e.stack),message:e.message,stack:e.stack,meta:{lifecycleHook:n,componentName:c(o),trace:o?function(e){if((e?.__isVue||e?._isVue)&&e.$parent){const o=[];for(;e;)o.push(c(e)),e=e.$parent;return o.reverse().join("--\x3e")}return c(e,!0)}(o):"",vm:o,error:e}};y(n)}},f=function(){window.addEventListener("error",o=>{o.preventDefault();const n=o.target;if(1===n.nodeType){let e="";e="link"===n.nodeName.toLowerCase()?n.href:n.currentSrc||n.src;o={type:"resourceError",errorUid:r(`resource-${o.error.message}-`+o.filename),message:o.error.message,stack:o.error.stack,meta:{src:e,html:n.outerHTML,tagName:n.tagName}};y(o)}},!0)},p=function(){const n=window.console.error;window.console.error=function(...e){var o={errorUid:r("console-"+e),type:"consoleError",meta:{errData:e}};y(o),n.apply(this,e)},window.addEventListener("error",e=>{var o,n,t;e.error&&(e.preventDefault(),{lineno:e,colno:o,error:t,filename:n}=e,t={stack:t.stack,message:t.message,errorUid:r(`js-${t.message}-`+n),type:"jsError",meta:{filename:n,lineno:e,colno:o}},y(t))},!0)},g=function(){window.addEventListener("unhandledrejection",function(e){e={stack:e.reason?.stack,message:e.reason?.message,errorUid:r("unhandledrejection-"+e.reason?.message),type:"promiseError"};y(e)})},h=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,w=10;function v(e){if(!e)return[];const o=[];for(const t of e.split("\n").slice(1)){n=(n=(n=t).match(h))?{filename:n[2],functionName:n[1]||"",lineno:parseInt(n[3],10)||void 0,colno:parseInt(n[4],10)||void 0}:{};n&&o.push(n)}var n;return o.slice(0,w)}function y(e){b.includes(e.errorUid)||(b.push(e.errorUid),e.stack&&(e.stackTrace=v(e.stack)),e.pageInformation=u(),o(e))}function k(e){console.log(e),e=e.error,console.log("init--options",e);var{resource:e,promise:o,js:n,vue:t}=e;e&&f(),n&&p(),o&&g(),t&&m(t)}const b=[];return{init:k,install:function(e,o){k(o),e.prototype?e.prototype.$monitor={}:e.config.globalProperties.$monitor={}}}});
