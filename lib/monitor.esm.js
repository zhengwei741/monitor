const nextTime=window.requestIdleCallback||window.requestAnimationFrame||(e=>setTimeout(e,17)),getErrorUid=e=>window.btoa(unescape(encodeURIComponent(e)));let caches=[];const max=5;let baseUrl="",baseInfo={},timer=void 0;const report=function(e,r=!1){r?sendBeacon(baseUrl,{baseInfo:baseInfo,eventInfo:[e]}):(caches.push(e),clearTimeout(timer),caches.length>=max?send():timer=window.setTimeout(send,5e3))},send=function(){if(caches.length){const r=caches.slice(0,max);caches=caches.slice(max);var e=Date.now();sendBeacon(baseUrl,{...baseInfo,sendTime:e,data:r.map(e=>e)}),caches.length&&nextTime(send)}},sendBeacon=(e,r)=>{console.log(e,"--------------url"),console.log(r,"--------------data")},getPageInfo=(window.addEventListener("beforeunload",()=>{send()}),function(){var{host:e,hostname:r,href:o,protocol:n,origin:t,port:a,pathname:i,search:s,hash:c}=window.location,{width:l,height:m}=window.screen;const{language:d,userAgent:u}=navigator;return{host:e,hostname:r,href:o,protocol:n,origin:t,port:a,pathname:i,search:s,hash:c,title:document.title,language:d.substring(0,2),userAgent:u,winScreen:l+"x"+m,docScreen:`${document.documentElement.clientWidth||document.body.clientWidth}x`+(document.documentElement.clientHeight||document.body.clientHeight)}}),classifyRE=/(?:^|[-_])(\w)/g,classify=e=>e.replace(classifyRE,e=>e.toUpperCase()).replace(/[-_]/g,""),formatComponentName=function(e,r){if(!e)return"<Anonymous>";if(e.$root===e)return"<Root>";var e=e.$options;let o=e.name||e._componentTag;const n=e.__file;return((o=!o&&n&&(e=n.match(/([^/\\]+)\.vue$/))?e[1]:o)?`<${classify(o)}>`:"<Anonymous>")+(n&&r?"at "+n:"")},generateComponentTrace=function(e){if((e?.__isVue||e?._isVue)&&e.$parent){const r=[];for(;e;)r.push(formatComponentName(e)),e=e.$parent;return r.reverse().join("--\x3e")}return formatComponentName(e,!0)},initVueError=function(e){e.config.errorHandler=function(e,r,o){o={type:"vueError",errorUid:getErrorUid(`vue-${e.message}-`+e.stack),message:e.message,stack:e.stack,meta:{lifecycleHook:o,componentName:formatComponentName(r),trace:r?generateComponentTrace(r):"",vm:r,error:e}};reportErrorHandle(o)}},init$1=function(e){var{resource:e,promise:r,js:o,vue:n}=e;e&&initResourceError(),o&&initJSError(),r&&initPromiseError(),n&&initVueError(n)},initResourceError=function(){window.addEventListener("error",r=>{r.preventDefault();const o=r.target;if(1===o.nodeType){let e="";e="link"===o.nodeName.toLowerCase()?o.href:o.currentSrc||o.src;r={type:"resourceError",errorUid:getErrorUid(`resource-${r.error.message}-`+r.filename),message:r.error.message,stack:r.error.stack,meta:{src:e,html:o.outerHTML,tagName:o.tagName}};reportErrorHandle(r)}},!0)},initJSError=function(){const o=window.console.error;window.console.error=function(...e){var r={errorUid:getErrorUid("console-"+e),type:"consoleError",meta:{errData:e}};reportErrorHandle(r),o.apply(this,e)},window.addEventListener("error",e=>{var r,o,n;e.error&&(e.preventDefault(),{lineno:e,colno:r,error:n,filename:o}=e,n={stack:n.stack,message:n.message,errorUid:getErrorUid(`js-${n.message}-`+o),type:"jsError",meta:{filename:o,lineno:e,colno:r}},reportErrorHandle(n))},!0)},initPromiseError=function(){window.addEventListener("unhandledrejection",function(e){e={stack:e.reason?.stack,message:e.reason?.message,errorUid:getErrorUid("unhandledrejection-"+e.reason?.message),type:"promiseError"};reportErrorHandle(e)})},FULL_MATCH=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,STACKTRACE_LIMIT=10;function parseStackLine(e){e=e.match(FULL_MATCH);return e?{filename:e[2],functionName:e[1]||"",lineno:parseInt(e[3],10)||void 0,colno:parseInt(e[4],10)||void 0}:{}}function parseStackFrames(e){if(!e)return[];const r=[];for(const n of e.split("\n").slice(1)){var o=parseStackLine(n);o&&r.push(o)}return r.slice(0,STACKTRACE_LIMIT)}const submitErrorids=[],reportErrorHandle=function(e){submitErrorids.includes(e.errorUid)||(submitErrorids.push(e.errorUid),e.stack&&(e.stackTrace=parseStackFrames(e.stack)),e.pageInformation=getPageInfo(),report(e))},init=function(e){normalizeConfig(e);e=e.error;console.log("init--options",e),init$1(e)},normalizeConfig=function(e){console.log(e)},install=function(e,r){init(r),e.prototype?e.prototype.$monitor={}:e.config.globalProperties.$monitor={}};var index={init:init,install:install};export{index as default};
