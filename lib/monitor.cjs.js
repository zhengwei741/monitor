"use strict";const nextTime=window.requestIdleCallback||window.requestAnimationFrame||(e=>setTimeout(e,17));function getPageURL(){return window.location.href}let caches=[];const max=5;let baseUrl="",baseInfo={},timer=void 0;const report=function(e,n=!1){n?sendBeacon(baseUrl,{baseInfo:baseInfo,eventInfo:[e]}):(caches.push(e),clearTimeout(timer),caches.length>=max?send():timer=window.setTimeout(send,5e3))},send=function(){if(caches.length){const n=caches.slice(0,max);caches=caches.slice(max);var e=Date.now();sendBeacon(baseUrl,{...baseInfo,sendTime:e,data:n.map(e=>e)}),caches.length&&nextTime(send)}},sendBeacon=(e,n)=>{console.log(e,"--------------url"),console.log(n,"--------------data")};window.addEventListener("beforeunload",()=>{send()});var e,t,n,i,r=function(e,n){return{name:e,value:void 0===n?-1:n,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},a=function(e,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var t=new PerformanceObserver(function(e){return e.getEntries().map(n)});return t.observe({type:e,buffered:!0}),t}}catch(e){}},o=function(n,t){function i(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||(n(e),t&&(removeEventListener("visibilitychange",i,!0),removeEventListener("pagehide",i,!0)))}addEventListener("visibilitychange",i,!0),addEventListener("pagehide",i,!0)},u=function(n){addEventListener("pageshow",function(e){e.persisted&&n(e)},!0)},c=function(n,t,i){var o;return function(e){0<=t.value&&(e||i)&&(t.delta=t.value-(o||0),!t.delta&&void 0!==o||(o=t.value,n(t)))}},f=-1,s=function(){return"hidden"===document.visibilityState?0:1/0},m=function(){o(function(e){e=e.timeStamp;f=e},!0)},v=function(){return f<0&&(f=s(),m(),u(function(){setTimeout(function(){f=s(),m()},0)})),{get firstHiddenTime(){return f}}},d=function(n,t){function e(e){"first-contentful-paint"===e.name&&(p&&p.disconnect(),e.startTime<o.firstHiddenTime&&(s.value=e.startTime,s.entries.push(e),i(!0)))}var i,o=v(),s=r("FCP"),f=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],p=f?null:a("paint",e);(f||p)&&(i=c(n,s,t),f&&e(f),u(function(e){s=r("FCP"),i=c(n,s,t),requestAnimationFrame(function(){requestAnimationFrame(function(){s.value=performance.now()-e.timeStamp,i(!0)})})}))},p=!1,l=-1,h=function(n,e){p||(d(function(e){l=e.value}),p=!0);function t(e){-1<l&&n(e)}function i(e){var n,t;e.hadRecentInput||(n=v[0],t=v[v.length-1],m&&e.startTime-t.startTime<1e3&&e.startTime-n.startTime<5e3?(m+=e.value,v.push(e)):(m=e.value,v=[e]),m>f.value&&(f.value=m,f.entries=v,s()))}var s,f=r("CLS",0),m=0,v=[],g=a("layout-shift",i);g&&(s=c(t,f,e),o(function(){g.takeRecords().map(i),s(!0)}),u(function(){l=-1,f=r("CLS",m=0),s=c(t,f,e)}))},T={passive:!0,capture:!0},y=new Date,g=function(i,o){e||(e=o,t=i,n=new Date,w(removeEventListener),E())},E=function(){var o;0<=t&&t<n-y&&(o={entryType:"first-input",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+t},i.forEach(function(e){e(o)}),i=[])},S=function(e){var n,t,i,o;function r(){g(t,i),o()}function a(){o()}e.cancelable&&(n=(1e12<e.timeStamp?new Date:performance.now())-e.timeStamp,"pointerdown"==e.type?(t=n,i=e,o=function(){removeEventListener("pointerup",r,T),removeEventListener("pointercancel",a,T)},addEventListener("pointerup",r,T),addEventListener("pointercancel",a,T)):g(n,e))},w=function(n){["mousedown","keydown","touchstart","pointerdown"].forEach(function(e){return n(e,S,T)})},L=function(n,s){function f(e){e.startTime<p.firstHiddenTime&&(m.value=e.processingStart-e.startTime,m.entries.push(e),l(!0))}var p=v(),m=r("FID"),d=a("first-input",f),l=c(n,m,s);d&&o(function(){d.takeRecords().map(f),d.disconnect()},!0),d&&u(function(){m=r("FID"),l=c(n,m,s),i=[],t=-1,e=null,w(addEventListener),i.push(f),E()})},b={},F=function(n,t){function e(e){var n=e.startTime;n<f.firstHiddenTime&&(p.value=n,p.entries.push(e),i())}var i,s,f=v(),p=r("LCP"),m=a("largest-contentful-paint",e);m&&(i=c(n,p,t),s=function(){b[p.id]||(m.takeRecords().map(e),m.disconnect(),b[p.id]=!0,i(!0))},["keydown","click"].forEach(function(e){addEventListener(e,s,{once:!0,capture:!0})}),o(s,!0),u(function(e){p=r("LCP"),i=c(n,p,t),requestAnimationFrame(function(){requestAnimationFrame(function(){p.value=performance.now()-e.timeStamp,b[p.id]=!0,i(!0)})})}))};const supported={performance:!!window.performance,getEntriesByType:!(!window.performance||!performance.getEntriesByType),PerformanceObserver:"PerformanceObserver"in window,MutationObserver:"MutationObserver"in window,PerformanceNavigationTiming:"PerformanceNavigationTiming"in window},observeTiming=function(){let e=performance.timing;const n={};supported.getEntriesByType&&((t=performance.getEntriesByType("paint")).length&&(n.FMP=t[t.length-1].startTime),supported.PerformanceNavigationTiming&&(t=performance.getEntriesByType("navigation")[0])&&(e=t));var{domainLookupStart:t,domainLookupEnd:i,connectStart:o,connectEnd:r,secureConnectionStart:a,requestStart:c,responseStart:s,responseEnd:u,domInteractive:f,domContentLoadedEventEnd:p,loadEventStart:m,fetchStart:d}=e;console.log(e,"----------------t"),n.FP=u-d,n.TTI=f-d,n.DomReady=p-d,n.Load=m-d,n.FirseByte=s-t,n.DNS=i-t,n.TCP=r-o,n.SSL=a?r-a:0,n.TTFB=s-c,n.Trans=u-s,n.DomParse=f-u,n.Res=m-p,report({...n,type:"performance",pageURL:getPageURL()})},initFCP=function(){d(function(e){report({...e,pageURL:getPageURL(),subType:"fcp",type:"performance"})})},initLCP=function(){F(function(e){report({...e,pageURL:getPageURL(),subType:"lcp",type:"performance"})})},initFID=function(){L(function(e){report({...e,pageURL:getPageURL(),subType:"fid",type:"performance"})})},initCLS=function(){h(function(e){report({...e,pageURL:getPageURL(),subType:"cls",type:"performance"})})},observeResResourceFlow=function(){const l=[];const e=new PerformanceObserver(function(e){for(const d of e.getEntries()){var{name:n,transferSize:t,initiatorType:i,startTime:o,responseEnd:r,domainLookupEnd:a,domainLookupStart:c,connectStart:s,connectEnd:u,secureConnectionStart:f,responseStart:p,requestStart:m}=d;l.push({name:n,transferSize:t,initiatorType:i,startTime:o,responseEnd:r,dnsLookup:a-c,initialConnect:u-s,ssl:u-f,request:p-m,ttfb:p-m,contentDownload:p-m})}});e.observe({entryTypes:["resource"]});window.addEventListener("pageshow",()=>{e&&e.disconnect(),report({resourceList:l,subType:"resource",type:"performance"})},{once:!0,capture:!0})},init$1=function(e){console.log(e),observeTiming(),initFCP(),initLCP(),initFID(),initCLS(),observeResResourceFlow()},init=function(e){normalizeConfig(e),console.log("init"),init$1({})},normalizeConfig=function(e){console.log(e)},install=function(e,n){init(n),e.prototype?e.prototype.$monitor={}:e.config.globalProperties.$monitor={}};var index={init:init,install:install};module.exports=index;
